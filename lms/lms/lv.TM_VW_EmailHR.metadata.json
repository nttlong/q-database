{"options":{"viewOn":"lv.TM_EmailHR","pipeline":[{"$lookup":{"foreignField":"employee_code","as":"emp","from":"lv.HCSEM_Employees","localField":"employee_code"}},{"$unwind":{"path":"$emp","preserveNullAndEmptyArrays":false}},{"$lookup":{"foreignField":"department_code","as":"dept","from":"lv.HCSSYS_Departments","localField":"department_code"}},{"$unwind":{"path":"$dept","preserveNullAndEmptyArrays":false}},{"$project":{"note":"$note","department_code":"$department_code","employee_code":"$employee_code","employee_name":{"$concat":["$emp.last_name"," ","$emp.first_name"]},"email_address":"$email_address","department_name":{"$switch":{"default":"","branches":[{"case":{"$ne":["$dept.department_name",""]},"then":"$dept.department_name"}]}}}}]},"indexes":[]}